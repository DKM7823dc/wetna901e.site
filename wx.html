<!DOCTYPE html>
<html>
<head>
    <style>
        .container {
            padding: 20px;
            text-align: center;
        }
        
        .protocol-btn {
            margin: 10px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #07c160, #06ad56);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .tip {
            margin-top: 20px;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ä¼ä¸šå¾®ä¿¡è·³è½¬ç¤ºä¾‹</h2>
        
        <div>
            <button class="protocol-btn" onclick="openWechatWorkApp()">
                ğŸ“± æ‰“å¼€ä¼ä¸šå¾®ä¿¡App
            </button>
        </div>
        
        <div>
            <button class="protocol-btn" onclick="openWechatWorkChat()">
                ğŸ’¬ æ‰“å¼€ä¼ä¸šå¾®ä¿¡èŠå¤©
            </button>
        </div>
        
        <div>
            <button class="protocol-btn" onclick="openWechatWorkWeb()">
            ğŸŒ æ‰“å¼€ç½‘é¡µç‰ˆ
            </button>
        </div>
        
        <p class="tip">
            * åœ¨æ‰‹æœºä¸Šç‚¹å‡»å¯å°è¯•æ‰“å¼€ä¼ä¸šå¾®ä¿¡åº”ç”¨<br>
            * åœ¨ç”µè„‘ä¸Šä¼šè·³è½¬åˆ°ä¼ä¸šå¾®ä¿¡å®˜ç½‘
        </p>
    </div>
    
    <script>
        // æ‰“å¼€ä¼ä¸šå¾®ä¿¡åº”ç”¨
        function openWechatWorkApp() {
            const appScheme = 'wxwork://';
            const webUrl = 'https://work.weixin.qq.com/';
            
            // å°è¯•æ‰“å¼€åº”ç”¨
            window.location.href = appScheme;
            
            // å¦‚æœåº”ç”¨æœªå®‰è£…ï¼Œè·³è½¬ç½‘é¡µç‰ˆ
            setTimeout(() => {
                if (!document.hidden) {
                    window.location.href = webUrl;
                }
            }, 1000);
        }
        
        // æ‰“å¼€ä¼ä¸šå¾®ä¿¡èŠå¤©ï¼ˆéœ€è¦ç‰¹å®šæ ¼å¼ï¼‰
        function openWechatWorkChat() {
            // æ ¼å¼ï¼šwxwork://message?username=ç”¨æˆ·ID
            const chatScheme = 'wxwork://message';
            const webUrl = 'https://work.weixin.qq.com/';
            
            window.location.href = chatScheme;
            
            setTimeout(() => {
                if (!document.hidden) {
                    window.location.href = webUrl;
                }
            }, 1000);
        }
        
        // ç›´æ¥æ‰“å¼€ç½‘é¡µç‰ˆ
        function openWechatWorkWeb() {
            window.open('https://work.weixin.qq.com/', '_blank');
        }
        
        // æ£€æµ‹æ˜¯å¦åœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­
        function isInWechat() {
            const ua = navigator.userAgent.toLowerCase();
            return ua.indexOf('wxwork') > -1 || ua.indexOf('micromessenger') > -1;
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æµ‹ç¯å¢ƒ
        window.onload = function() {
            if (isInWechat()) {
                document.querySelector('.tip').innerHTML += '<br>æ£€æµ‹åˆ°æ‚¨åœ¨ä¼ä¸šå¾®ä¿¡/å¾®ä¿¡ä¸­æ‰“å¼€';
            }
        };
    </script>
</body>
</html>
